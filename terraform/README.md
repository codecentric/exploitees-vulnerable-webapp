# Terraform setup for webgoat
Set up a [webgoat](https://github.com/WebGoat/WebGoat) instance, optionally only reachable from within a defined address range.

Sets up
- VPC, subnets, security groups
- Load Balancer
- Instance of WebGoat
- TLS certificate (opt.)
- DNS entry (opt.)

In order to create a TLS certificate and a DNS entry, you need to provide the name of a Route53 hosted zone.
Inside this zone, a new subdomain "webgoat" is created for which the TLS certificate is issued.

If you omit the hosted zone, the Load Balancer is configured without TLS.

# Setup
## Initialize terraform

    terraform init

## Apply
The workshop users need to be created first, since the cloud9 environments are bound to the user's ARNs.

    terraform apply -target=aws_iam_user_login_profile.workshop_user

Execute the terraform plan. Optionally restrict ingress to the webgoat instance to ip addresses coming from a cidr block.

    terraform apply -var="restrict_to_cidr=1.2.3.4/32"