provider "aws" {
  region = local.region
}

locals {
  region               = "eu-central-1"
  subdomain_name       = "webgoat"
  domain_name          = "${local.subdomain_name}.${var.route53_zone_name}"
}

module "dns-tls" {
  source = "./tls"
  count = var.route53_zone_name != "" ? 1 : 0

  route53_zone_name = var.route53_zone_name
  domain_name = local.domain_name
  lb_dns_name = module.alb.lb_dns_name
  lb_zone_id = module.alb.lb_zone_id
}

output "url" {
  value = var.route53_zone_name != "" ? "https://${local.domain_name}" : "http://${module.alb.lb_dns_name}"
}
